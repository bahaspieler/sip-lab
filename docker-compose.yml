services:
  sipp_uac:
    image: ctaloi/sipp:latest
    platform: linux/amd64
    container_name: sipp_uac
    entrypoint: ["/bin/sh", "-lc"]
    command: ["while true; do sleep 3600; done"]
    networks:
      sipnet:
        ipv4_address: 172.20.0.2
    volumes:
      - ./sipp:/sipp:ro

  sipp_uas:
    image: ctaloi/sipp:latest
    platform: linux/amd64
    container_name: sipp_uas
    entrypoint: ["/bin/sh", "-lc"]
    command: ["while true; do sleep 3600; done"]
    networks:
      sipnet:
        ipv4_address: 172.20.0.3
    volumes:
      - ./sipp:/sipp:ro

  capture:
    image: nicolaka/netshoot:latest
    container_name: capture
    command: ["sleep", "infinity"]
    cap_add: ["NET_ADMIN", "NET_RAW"]
    network_mode: "service:sipp_uac"
    volumes:
      - ./captures:/captures


networks:
  sipnet:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.0.0/24